{% extends 'calendarapp/base.html' %}
{% load static %}

{% block header %}
<img src="{% static 'croissant/image/logo.png' %}" alt="ロゴ">
<link href="{% static 'croissant/fullcalendar/main.css' %}" rel='stylesheet' />
<script src="{% static 'croissant/fullcalendar/main.js' %}"></script>
<!-- ポップアップ表示のライブラリSweetAlert -->
<script src= "https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

<script>
    var events = {{ event_list|safe }};
    console.log(events[2].summary)

    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'ja',
            firstDay: (new Date()).getDay(),
            validRange: {
                start: new Date()
            },
            scrollTime: '08:00',
            initialView: 'timeGridWeek',
            nowIndicator: false,
            allDaySlot: false,
            customButtons: {
                logout: {
                    text: 'logout',
                    click: function() {
                        alert('clicked the logout button!');
                    }
                },
                request: {
                    text: 'request',
                    click: function() {
                        alert('clicked the request button!');
                    }
                },
                share: {
                    text: 'share',
                    click: function() {
                        swal({
                          title: "http://127.0.0.1:8000/calendar/requester_main",
                          text: "友達にシェアしよう！",
                          icon: "success",
                          button: "閉じる",
                        });
                    }
                }
            },
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'share,request,logout'
            },
            eventClick: function(info) {
                alert('Evet: ' + info.event.title);
            },


            navLinks: false, // can click day/week names to navigate views
            editable: false,
            selectable: false,
            selectMirror: true,
            dayMaxEvents: true, // allow "more" link when too many events

            eventSources: [{
                events:events,
                color: 'gray',
                textColor: 'black'
            }]
        });

        calendar.render();
    });

</script>
{% endblock header %}

{% block content %}
<div id="calendar"></div>
{% endblock content %}
